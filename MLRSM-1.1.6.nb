(* This is a computational implementation of an advance particle model, the left-right symmetric model. *)
(* The script is written in FeynRules, which is a Mathematica package. *)
(* The model describes three out of the four fundemental forces of nature: the electromagnetic, weak, and strong.*)
(* The model is based on group theory principles. It contains the possible particles and interactions generated *)
(* by a Lagrangian which is invariant under transformations from certain symmetry groups (SU(3) × SU(2)L/R × U(1)). *)


(***************************************************************************************************************)
(******                       This is the FeynRules mod-file for the MLRSM(QMLRSM)                        ******)
(******                                                                                                   ******)
(******     Authors: G. Eilam, S. Bar-Shalom, A. Roitgrund                                                ******)
(******                                                                                                   ******)
(****** Feynman gauge is set to False,                                                                    ******)
(****** unitary gauge is assumed.                                                                           ****)
(***************************************************************************************************************)

(* ************************** *)
(* *****  Information   ***** *)
(* ************************** *)
M$ModelName = "MLRSM-1.1.5h";

M$Information = {
  Authors      -> {"G. Eilam", "S. Bar-Shalom", "A. Roitgrund"}, 
  Version      -> "1.1.6",
  Date         -> "1. 10. 2015",
  Institutions -> {"Technion - Israel Insititute of Technology"}.
  Emails       -> {"eilam@physics.technion.ac.il", "shaouly@physics.technion.ac.il", "aviadroi@gmail.com"},
  URLs         -> "https://drive.google.com/folderview?id=0BxMAGX_Tlpi9X0RUZW9tS2RaQ0E&usp=sharing"
};

FeynmanGauge = False;

(* v.1.1.3: Error corrected - reverse sign in Yukawa Higgs triplet lepton interactions: added "-" before yHM1 and yHM2 in line 1314 *)
(* v.1.1.3: eigenstates correction:
			Phi01 -> (k1*vev + k1 H - k2 H01 - I k1 G01 + I k2 A01)/(vev*Sqrt[2])
			Phi02 -> (k2*vev + k2 H + k1 H01 + I k2 G01 + I k1 A01)/(vev*Sqrt[2])
			in lines 585 and 592, respectively  *)
(* v.1.1.3: Gluon ghost part added. No effect on Feynman rules. *)
(* v.1.1.4: Indices correction - LCL and LCR doublets. No effect on Feynman rules. *)
(* v.1.1.4: PDG number correction. No effect on Feynman rules. *)
(* v.1.1.4: Added external parametrization to CKM matrices. *)
(* v.1.1.5: Added external parametrization to internal block in KL to match the unitary PMNS matrix. *)
(* v.1.1.5: Accurate expressions for charged and neutral gauge bosons mixing angles and masses of W2 and Z2 replace the former ones given in the approximation vR>>k1,k2 *)
(* v.1.1.5: Accurate expressions for charged Higgs states replace the former ones given in the approximation vR>>k1,k2 *)
(* v.1.1.6: Error corrected - expression for mu parameters: power of the ew (k1^2+k2^2) term was changed from 1/2 to 1 (only relavant for the Higgs self interactions) *)


(* ************************** *)
(* *****  Gauge groups  ***** *)
(* ************************** *)
M$GaugeGroups = {
  U1Y  == { 
    Abelian          -> True,  
    CouplingConstant -> g1, 
    GaugeBoson       -> B, 
    Charge           -> Y
  },
  SU2L == { 
    Abelian           -> False, 
    CouplingConstant  -> gw, 
    GaugeBoson        -> Wi, 
    StructureConstant -> Eps, 
    Representations   -> {Ta,SU2D}, 
    Definitions       -> {Ta[a_,b_,c_]->PauliSigma[a,b,c]/2, FSU2L[i_,j_,k_]:> I Eps[i,j,k]}
  },
  SU2R == { 
    Abelian           -> False, 
    CouplingConstant  -> gw, 
    GaugeBoson        -> WRi, 
    StructureConstant -> Eps, 
    Representations   -> {RTa,RSU2D}, 
    Definitions       -> {RTa[a_,b_,c_]->PauliSigma[a,b,c]/2, FSU2R[i_,j_,k_]:> I Eps[i,j,k]}
  },
  SU3C == { 
    Abelian           -> False, 
    CouplingConstant  -> gs, 
    GaugeBoson        -> G,
    StructureConstant -> f, 
    Representations   -> {T,Colour}, 
    DTerm             -> dSUN
  } 
};


(* ************************** *)
(* *****    Indices     ***** *)
(* ************************** *)

IndexRange[Index[SU2W      ]] = Unfold[Range[3]]; 
IndexRange[Index[SU2W2     ]] = Unfold[Range[3]]; 
IndexRange[Index[SU2D      ]] = Unfold[Range[2]];
IndexRange[Index[RSU2D     ]] = Unfold[Range[2]];
IndexRange[Index[Dim2      ]] = Unfold[Range[2]];
IndexRange[Index[Gluon     ]] = NoUnfold[Range[8]];
IndexRange[Index[Colour    ]] = NoUnfold[Range[3]]; 
IndexRange[Index[Generation]] = Range[3];
IndexRange[Index[Gen2      ]] = Range[6];
IndexRange[Index[MusqI     ]] = Range[3];

IndexStyle[SU2W,       j];
IndexStyle[SU2W2,      h];
IndexStyle[SU2D,       o];
IndexStyle[RSU2D,      k];
IndexStyle[Gluon,      a];
IndexStyle[Colour,     m];
IndexStyle[Generation, f];
IndexStyle[Gen2,      rr];
IndexStyle[MusqI,    mus];
IndexStyle[Dim2,     dm2];

(* ************************** *)
(* *** Interaction orders *** *)
(* ***  (as used by mg5)  *** *)
(* ************************** *)

M$InteractionOrderHierarchy = {
  {QCD, 1},
  {QED, 2}
};


(* ************************** *)
(* **** Particle classes **** *)
(* ************************** *)
M$ClassesDescription = {

(* Gauge bosons: physical vector fields *)
  V[1] == { 
    ClassName       -> A, 
    SelfConjugate   -> True,  
    Mass            -> 0,  
    Width           -> 0,  
    ParticleName    -> "a", 
    PDG             -> 22, 
    PropagatorLabel -> "a", 
    PropagatorType  -> W, 
    PropagatorArrow -> None,
    FullName        -> "Photon"
  },
  V[2] == { 
    ClassName       -> Z, 
    SelfConjugate   -> True,
    Mass            -> {MZ, 91.1876},
    Width           -> {WZ, 2.4952},
    ParticleName    -> "Z", 
    PDG             -> 23, 
    PropagatorLabel -> "Z",
    PropagatorType  -> Sine,
    PropagatorArrow -> None,
    FullName        -> "Z"
  },
  V[3] == {
    ClassName        -> W,
    SelfConjugate    -> False,
    Mass             -> {MW, 80.399},
    Width            -> {WW, 2.08},
    ParticleName     -> "W+",
    AntiParticleName -> "W-",
    QuantumNumbers   -> {Q -> 1},
    PDG              -> 24, 
    PropagatorLabel  -> "W",
    PropagatorType   -> Sine,
    PropagatorArrow  -> Forward,
    FullName         -> "W"
  },
  V[4] == {
    ClassName        -> G,
    SelfConjugate    -> True,
    Indices          -> {Index[Gluon]},
    Mass             -> 0,
    Width            -> 0,
    ParticleName     -> "g", 
    PDG              -> 21,
    PropagatorLabel  -> "G",
    PropagatorType   -> C,
    PropagatorArrow  -> None,
    FullName         -> "G"
  },
  V[5] == {
    ClassName        -> W2,
    SelfConjugate    -> False,
    Mass             -> {MW2, Internal},
    Width            -> {WW2, 69},
    ParticleName     -> "W2+",
    AntiParticleName -> "W2-",
    QuantumNumbers   -> {Q -> 1},
    PDG              -> 34, 
    PropagatorLabel  -> "W2",
    PropagatorType   -> Sine,
    PropagatorArrow  -> Forward,
    FullName         -> "W2"
  },
  V[6] == {
    ClassName        -> Z2,
    SelfConjugate    -> True,
    Mass             -> {MZ2, Internal},
    Width            -> {WZ2, 80},
    ParticleName     -> "Z2",
    PDG              -> 32, 
    PropagatorLabel  -> "Z2",
    PropagatorType   -> Sine,
    PropagatorArrow  -> None,
    FullName         -> "Z2"
  },
  
(* Ghosts: related to physical gauge bosons *)  
  
  U[4] == { 
    ClassName       -> ghG, 
    SelfConjugate   -> False,
    Indices         -> {Index[Gluon]},
    Ghost           -> G,
    QuantumNumbers  ->{GhostNumber -> 1}, 
    Mass            -> 0,
    PropagatorLabel -> "uG",
    PropagatorType  -> GhostDash,
    PropagatorArrow -> Forward
  },
  
(* Gauge bosons: unphysical vector fields *)
  V[11] == { 
    ClassName     -> B, 
    Unphysical    -> True, 
    SelfConjugate -> True, 
    Definitions   -> { B[mu_] -> (-sw*Sqrt[1-2*sw^2]/cw*cphi+sw/cw*sphi)*Z[mu]-(sw*Sqrt[1-2*sw^2]/cw*sphi+sw/cw*cphi)*Z2[mu]+Sqrt[1-2*sw^2]*A[mu]} 
  }, 
   V[12] == { 
    ClassName     -> Wi,
    Unphysical    -> True,
    SelfConjugate -> True, 
    Indices       -> {Index[SU2W]},
    FlavorIndex   -> SU2W,
    Definitions   -> { Wi[mu_,1] -> ((Wbar[mu]*cxi+W2bar[mu]*sxi)+(W[mu]*cxi+W2[mu]*sxi))/Sqrt[2], 
					   Wi[mu_,2] -> ((Wbar[mu]*cxi+W2bar[mu]*sxi)-(W[mu]*cxi+W2[mu]*sxi))/(I*Sqrt[2]), 
					   Wi[mu_,3] -> cw*cphi*Z[mu]+cw*sphi*Z2[mu]+sw*A[mu] }
  },
  V[13] == { 
    ClassName     -> WRi,
    Unphysical    -> True,
    SelfConjugate -> True, 
    Indices       -> {Index[SU2W2]},
    FlavorIndex   -> SU2W2,
    Definitions   -> { WRi[mu_,1] -> ((-Wbar[mu]*sxi+W2bar[mu]*cxi)+(-W[mu]*sxi+W2[mu]*cxi))/Sqrt[2], 
					   WRi[mu_,2] -> ((-Wbar[mu]*sxi+W2bar[mu]*cxi)-(-W[mu]*sxi+W2[mu]*cxi))/(I*Sqrt[2]), 
					   WRi[mu_,3] -> (-sw^2/cw*cphi-Sqrt[1-2*sw^2]/cw*sphi)*Z[mu]+(-sw^2/cw*sphi+Sqrt[1-2*sw^2]/cw*cphi)*Z2[mu]+sw*A[mu] }
  },

(* Fermions: physical fields *)
 
  F[2] == {
    ClassName        -> l,
    ClassMembers     -> {e, mu, ta},
    Indices          -> {Index[Generation]},
    FlavorIndex      -> Generation,
    SelfConjugate    -> False,
    Mass             -> {Ml, {Me,5.11*^-4}, {Mmu,0.10566}, {Mta,1.777}},
    Width            -> 0,
    QuantumNumbers   -> {Q -> -1, LeptonNumber -> 1},
    PropagatorLabel  -> {"l", "e", "mu", "ta"},
    PropagatorType   -> Straight,
    PropagatorArrow  -> Forward,
    PDG              -> {11, 13, 15},
    ParticleName     -> {"e-", "mu-", "ta-"},
    AntiParticleName -> {"e+", "mu+", "ta+"},
    FullName         -> {"Electron", "Muon", "Tau"} 
  },
   F[3] == {
    ClassName        -> uq,
    ClassMembers     -> {u, c, t},
    Indices          -> {Index[Generation], Index[Colour]},
    FlavorIndex      -> Generation,
    SelfConjugate    -> False,
    Mass             -> {Mu, {MU, 2.55*^-3}, {MC,1.27}, {MT,172}},
    Width            -> {0, 0, {WT,1.50833649}},
    QuantumNumbers   -> {Q -> 2/3},
    PropagatorLabel  -> {"uq", "u", "c", "t"},
    PropagatorType   -> Straight,
    PropagatorArrow  -> Forward,
    PDG              -> {2, 4, 6}, 
    ParticleName     -> {"u",  "c",  "t" },
    AntiParticleName -> {"u~", "c~", "t~"},
    FullName         -> {"u-quark", "c-quark", "t-quark"}
  },
  F[4] == {
    ClassName        -> dq,
    ClassMembers     -> {d, s, b},
    Indices          -> {Index[Generation], Index[Colour]},
    FlavorIndex      -> Generation,
    SelfConjugate    -> False,
    Mass             -> {Md, {MD,5.04*^-3}, {MS,0.101}, {MB,4.7}},
    Width            -> 0,
    QuantumNumbers   -> {Q -> -1/3},
    PropagatorLabel  -> {"dq", "d", "s", "b"},
    PropagatorType   -> Straight, 
    PropagatorArrow  -> Forward,
    PDG              -> {1,3,5},
    ParticleName     -> {"d",  "s",  "b" },
    AntiParticleName -> {"d~", "s~", "b~"},
    FullName         -> {"d-quark", "s-quark", "b-quark"}
  },
    F[5] == {
    ClassName        -> Nl,
    ClassMembers     -> {N1,N2,N3,N4,N5,N6},
    Indices          -> {Index[Gen2]},
    FlavorIndex      -> Gen2,
    SelfConjugate    -> True,
    Mass             -> {MN, {MN1,10*^-9}, {MN2,10*^-9}, {MN3,10*^-9}, {MN4,100}, {MN5,100}, {MN6,100}},
    Width            -> {0,0,0,{WN4,1.5},{WN5,1.5},{WN6,1.5}},
    PropagatorLabel  -> {"N", "N1", "N2", "N3", "N4", "N5", "N6"},
    PropagatorType   -> Straight,
    PropagatorArrow  -> None,
    PDG              -> {12,14,16,9900012,9900014,9900016},
    FullName         -> {"Light-electron-neutrino", "Light-Mu-neutrino", "Light-tau-neutrino", "Heavy-electron-neutrino", "heavy-mu-neutrino", "Heavy-tau-neutrino"}
  }, 
(* Fermions: unphysical fields *)
  F[11] == { 
    ClassName      -> LR, 
    Unphysical     -> True, 
    Indices        -> {Index[RSU2D], Index[Generation]},
    FlavorIndex    -> RSU2D,
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> -1/2},
    Definitions    -> { LR[sp1_,1,ff_] :> Module[{sp2,ff2}, Conjugate[KR[ff2,ff]] ProjP[sp1,sp2] Nl[sp2,ff2]], LR[sp1_,2,ff_] :> Module[{sp2}, ProjP[sp1,sp2] l[sp2,ff]] }
  },
  F[12] == { 
    ClassName      -> LCL, 
    Unphysical     -> True, 
    Indices        -> {Index[RSU2D], Index[Generation]},
    FlavorIndex    -> RSU2D,
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1/2},
    Definitions    -> { LCL[sp1_,1,ff_] :> Module[{sp2,ff2}, KR[ff2,ff] ProjM[sp1,sp2] Nl[sp2,ff2]], LCL[sp1_,2,ff_] :> Module[{sp2}, ProjM[sp1,sp2] CC[l[sp2,ff]]] }
  },
   F[13] == { 
    ClassName      -> LL, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D], Index[Generation]},
    FlavorIndex    -> SU2D,
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> -1/2},
    Definitions    -> { LL[sp1_,1,ff_] :> Module[{sp2,ff2}, Conjugate[KL[ff2,ff]] ProjM[sp1,sp2] Nl[sp2,ff2]], LL[sp1_,2,ff_] :> Module[{sp2}, ProjM[sp1,sp2] l[sp2,ff]] }
  },
 F[14] == { 
    ClassName      -> LCR, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D], Index[Generation]},
    FlavorIndex    -> SU2D,
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1/2},
    Definitions    -> { LCR[sp1_,1,ff_] :> Module[{sp2,ff2}, KL[ff2,ff] ProjP[sp1,sp2] Nl[sp2,ff2]], LCR[sp1_,2,ff_] :> Module[{sp2}, ProjP[sp1,sp2] CC[l[sp2,ff]]] }
  },
   F[15] == { 
    ClassName      -> QL, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D], Index[Generation], Index[Colour]},
    FlavorIndex    -> SU2D,
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1/6},
    Definitions    -> { 
      QL[sp1_,1,ff_,cc_] :> Module[{sp2}, ProjM[sp1,sp2] uq[sp2,ff,cc]], 
      QL[sp1_,2,ff_,cc_] :> Module[{sp2,ff2}, CKML[ff,ff2] ProjM[sp1,sp2] dq[sp2,ff2,cc]] }
  },
   F[16] == { 
    ClassName      -> QR, 
    Unphysical     -> True, 
    Indices        -> {Index[RSU2D], Index[Generation], Index[Colour]},
    FlavorIndex    -> RSU2D,
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1/6},
    Definitions    -> { 
      QR[sp1_,1,ff_,cc_] :> Module[{sp2}, ProjP[sp1,sp2] uq[sp2,ff,cc]], 
      QR[sp1_,2,ff_,cc_] :> Module[{sp2,ff2}, CKMR[ff,ff2] ProjP[sp1,sp2] dq[sp2,ff2,cc]] }
  },
(* Higgs: physical scalars  *)
  S[1] == {
    ClassName       -> H,
    SelfConjugate   -> True,
    Mass            -> {MH,Internal},
    Width           -> {WH,0.0057},
    PropagatorLabel -> "H",
    PropagatorType  -> D,
    PropagatorArrow -> None,
    PDG             -> 25,
    ParticleName    -> "H",
    FullName        -> "Neutral-Higgs0"
  }, 
  S[2] == {
    ClassName       -> H01,
    SelfConjugate   -> True,
    Mass            -> {MH01,Internal},
    Width           -> {WH01,0.00575308848},
    PropagatorLabel -> "H01",
    PropagatorType  -> D,
    PropagatorArrow -> None,
    PDG             -> 35,
    ParticleName    -> "H01",
    FullName        -> "Neutral-Higgs1"
  }, 
  S[3] == {
    ClassName       -> H02,
    SelfConjugate   -> True,
    Mass            -> {MH02,Internal},
    Width           -> {WH02,0.00575308848},
    PropagatorLabel -> "H02",
    PropagatorType  -> D,
    PropagatorArrow -> None,
    PDG             -> 43,
    ParticleName    -> "H02",
    FullName        -> "Neutral-Higgs2"
  }, 
  S[4] == {
    ClassName       -> H03,
    SelfConjugate   -> True,
    Mass            -> {MH03,Internal},
    Width           -> {WH03,0.00575308848},
    PropagatorLabel -> "H03",
    PropagatorType  -> D,
    PropagatorArrow -> None,
    PDG             -> 44,
    ParticleName    -> "H03",
    FullName        -> "Neutral-Higgs3"
  }, 
 S[9] == {
    ClassName       -> HP1,
    SelfConjugate   -> False,
    Mass            -> {MHP1,Internal},
    Width           -> {WHP1,0.006},
    QuantumNumbers  -> {Q -> 1},
    ParticleName    -> "HP1",
    AntiParticleName -> "HM1",
    PropagatorLabel -> "H1+",
    PropagatorType  -> D,
    PropagatorArrow -> Forward,
    PDG             -> 37,
    FullName        -> "Charged-Higgs1"
  },
 S[10] == {
    ClassName       -> HP2,
    SelfConjugate   -> False,
    Mass            -> {MHP2,Internal},
    Width           -> {WHP2,0.006},
    QuantumNumbers  -> {Q -> 1},
    ParticleName    -> "HP2",
    AntiParticleName -> "HM2",
    PropagatorLabel -> "H2+",
    PropagatorType  -> D,
    PropagatorArrow -> Forward,
    PDG             -> 38,
    FullName        -> "Charged-Higgs2"
  },  
 S[11] == {
    ClassName       -> HPPL,
    SelfConjugate   -> False,
    Mass            -> {MHPPL,Internal},
    Width           -> {WHPPL,0.007},
    QuantumNumbers  -> {Q -> 2},
    ParticleName    -> "HL++",
    AntiParticleName -> "HL--",
    PropagatorLabel -> "HL++",
    PropagatorType  -> D,
    PropagatorArrow -> Forward,
    PDG             -> 61,
    FullName        -> "Doubly-charged-Higgs-L"
  },
 S[12] == {
    ClassName       -> HPPR,
    SelfConjugate   -> False,
    Mass            -> {MHPPR,Internal},
    Width           -> {WHPPR,0.007},
    QuantumNumbers  -> {Q -> 2},
    ParticleName    -> "HR++",
    AntiParticleName -> "HR--",
    PropagatorLabel -> "HR++",
    PropagatorType  -> D,
    PropagatorArrow -> Forward,
    PDG             -> 62,
    FullName        -> "Doubly-charged-Higgs-R"
  },
 S[13] == {
    ClassName       -> A01,
    SelfConjugate   -> True,
    Mass            -> {MA01,Internal},
    Width           -> {WA01,0.006},
    ParticleName    -> "A01",
    PropagatorLabel -> "A01",
    PropagatorType  -> D,
    PropagatorArrow -> None,
    PDG             -> 36,
    FullName        -> "Pseudo-Scalar-Higgs1"
  },
 S[14] == {
    ClassName       -> A02,
    SelfConjugate   -> True,
    Mass            -> {MA02,Internal},
    Width           -> {WA02,0.006},
    ParticleName    -> "A02",
    PropagatorLabel -> "A02",
    PropagatorType  -> D,
    PropagatorArrow -> None,
    PDG             -> 45,
    FullName        -> "Pseudo-Scalar-Higgs2"
  },
  
(* Higgs: unphysical scalars  *)

 S[15] == { 
    ClassName      -> H0L, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 0,Y -> 1},
    Definitions    -> { H0L -> (vL + H03 + I A02)/Sqrt[2]}
  },
 S[16] == { 
    ClassName      -> HPL, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 1,Y -> 1},
    Definitions    -> { HPL -> HP1}
  }, 
 S[17] == { 
    ClassName      -> HDPL, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 2,Y -> 1},
    Definitions    -> { HDPL -> HPPL}
  }, 
 S[18] == { 
    ClassName      -> H0R, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 0,Y -> 1},
    Definitions    -> { H0R -> (vR + H02)/Sqrt[2]}
  },
S[19] == { 
    ClassName      -> HPR, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 1,Y -> 1},
    Definitions    -> { HPR -> int3 HP2}
  }, 
 S[20] == { 
    ClassName      -> HDPR, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 2,Y -> 1},
    Definitions    -> { HDPR -> HPPR}
  },  
 S[21] == { 
    ClassName      -> Phi01, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 0,Y -> 0},
    Definitions    -> { Phi01 -> (k1*vev + k1 H - k2 H01 + I k2 A01)/(vev*Sqrt[2])}
  },  
 S[22] == { 
    ClassName      -> Phi02, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 0,Y -> 0},
    Definitions    -> { Phi02 -> (k2*vev + k2 H + k1 H01 + I k1 A01)/(vev*Sqrt[2])}
  },  
  S[23] == { 
    ClassName      -> PhiP1, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 1,Y -> 0},
    Definitions    -> { PhiP1 -> int1 HP2}
  },  
 S[24] == { 
    ClassName      -> PhiP2, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    QuantumNumbers -> {Q -> 1,Y -> 0},
    Definitions    -> { PhiP2 -> int2 HP2} 
  },   
 S[25] == { 
    ClassName      -> LT, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D],Index[SU2D]},
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1},
    Definitions    -> { LT[1,1] -> HPL/Sqrt[2], LT[1,2] -> HDPL, LT[2,1]-> H0L, LT[2,2] -> -HPL/Sqrt[2]}
  },
 S[26] == {  
    ClassName        -> LTdagger,
    Unphysical       -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[SU2D], Index[SU2D]},
    Unitary          -> False,
    Definitions      -> { 
    LTdagger[a_,b_] :> HC[LT[b,a]]},
    TeX              -> Superscript[LT,\[Dagger]], 
    Description      -> "Hermitian Conjugate of LT"
 },
 S[27] == { 
    ClassName     -> LCD,
    Unphysical    -> True, 
    SelfConjugate -> False,
    Indices       -> {Index[SU2D], Index[SU2D]},
    Unitary       -> False,
    Definitions   -> {
    LCD[a_,b_] :> Module[{zz,uu},del[LT[a,b],mu] - I gw/2 (Wi[mu,1] mult[Sig1,LT,a,b]+Wi[mu,2] mult[Sig2,LT,a,b]+Wi[mu,3] mult[Sig3,LT,a,b] 
                  - mult[LT,Sig1,a,b] Wi[mu,1] - mult[LT,Sig2,a,b] Wi[mu,2] - mult[LT,Sig3,a,b] Wi[mu,3]) - I g1 B[mu] LT[a,b]]},
    TeX           -> Superscript[V,LCD],
    Description -> "Covariant Derivative of LT"},
  S[28] == {  
    ClassName        -> LCDdagger,
    Unphysical       -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[SU2D], Index[SU2D]},
    Unitary          -> False,
    Definitions      -> { 
    LCDdagger[a_,b_] :> Module[{}, HC[LCD[b,a]]]},
    TeX              -> Superscript[V,LCDdagger], 
    Description      -> "Hermitian Conjugate of Covariant Derivative of LT"
 },
 S[29] == { 
    ClassName      -> SigL, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D],Index[SU2D]},
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1},
    Definitions    -> { SigL[1,1] -> H0L, SigL[1,2] -> -HPL/Sqrt[2],
						SigL[2,1] -> -HPL/Sqrt[2], SigL[2,2] -> -HDPL},
	TeX              -> \[CapitalSigma]L, 
    Description      -> "Leftt handed Higgs rearranged"						
	},
 S[30] == { 
    ClassName      -> RT, 
    Unphysical     -> True, 
    Indices        -> {Index[RSU2D],Index[RSU2D]},
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1},
    Definitions    -> { RT[1,1] -> HPR/Sqrt[2], RT[1,2] -> HDPR, RT[2,1]-> H0R, RT[2,2] -> -HPR/Sqrt[2]}
  },
 S[31] == {  
    ClassName        -> RTdagger,
    Unphysical       -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[RSU2D], Index[RSU2D]},
    Unitary          -> False,
    Definitions      -> { 
    RTdagger[a_,b_] :> HC[RT[b,a]]},
    TeX              -> Superscript[RT,\[Dagger]], 
    Description      -> "Hermitian Conjugate of RT"
 },
 S[32] == { 
    ClassName     -> RCD,
    Unphysical    -> True, 
    SelfConjugate -> False,
    Indices       -> {Index[RSU2D], Index[RSU2D]},
    Unitary       -> False,
    Definitions   -> {
    RCD[a_,b_] :> Module[{zz,uu},del[RT[a,b],mu] - I gw/2 (WRi[mu,1] mult[RSig1,RT,a,b]+WRi[mu,2] mult[RSig2,RT,a,b]+WRi[mu,3] mult[RSig3,RT,a,b] 
                  - mult[RT,RSig1,a,b] WRi[mu,1] - mult[RT,RSig2,a,b] WRi[mu,2] - mult[RT,RSig3,a,b] WRi[mu,3])  - I g1 B[mu] RT[a,b]]},
    TeX           -> Superscript[V,RCD],
    Description -> "Covariant Derivative of RT"},
 S[33] == {  
    ClassName        -> RCDdagger,
    Unphysical       -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[RSU2D], Index[RSU2D]},
    Unitary          -> False,
    Definitions      -> { 
    RCDdagger[a_,b_] :> Module[{}, HC[RCD[b,a]]]},
    TeX              -> Superscript[V,RCDdagger], 
    Description      -> "Hermitian Conjugate of Covariant Derivative of RT"
 },
 S[34] == { 
   ClassName       -> SigR, 
    Unphysical     -> True, 
    Indices        -> {Index[RSU2D],Index[RSU2D]},
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 1},
    Definitions    -> { SigR[1,1] -> H0R, SigR[1,2] -> -HPR/Sqrt[2],
						SigR[2,1] -> -HPR/Sqrt[2], SigR[2,2] -> -HDPR},
    TeX              -> \[CapitalSigma]R, 
    Description      -> "Right handed Higgs rearranged"						
	},
 S[35] == { 
    ClassName      -> BD, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D],Index[RSU2D]},
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 0},
    Definitions    -> { BD[1,1] -> Phi01, BD[1,2] -> PhiP1, BD[2,1]-> HC[PhiP2], BD[2,2] -> Phi02},
    TeX              -> Bd, 
    Description      -> "The Higgs bidoublet"
  },
  S[36] == {  
    ClassName        -> BDdagger,
    Unphysical        -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[RSU2D], Index[SU2D]},
    Unitary          -> False,
    Definitions      -> { 
    BDdagger[a_,b_] :> Module[{}, HC[BD[b,a]]]},
    TeX              -> Superscript[BD,\[Dagger]], 
    Description      -> "Hermitian Conjugate of BD"
 },
   S[37] == { 
    ClassName      -> BDtilde, 
    Unphysical     -> True, 
    Indices        -> {Index[SU2D],Index[RSU2D]},
    SelfConjugate  -> False,
    QuantumNumbers -> {Y -> 0},
    Definitions    -> { BDtilde[1,1] -> HC[Phi02], BDtilde[1,2] -> -PhiP2, BDtilde[2,1]-> -HC[PhiP1], BDtilde[2,2] -> HC[Phi01]},
    TeX              -> OverTilde[BD], 
    Description      -> "BDtilde matrix"
  },
  S[38] == {  
    ClassName        -> BDtildedagger,
    Unphysical       -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[RSU2D], Index[SU2D]},
    Unitary          -> False,
    Definitions      -> { 
    BDtildedagger[a_,b_] :> Module[{}, HC[BDtilde[b,a]]]},
    TeX              -> Superscript[OverTilde[BD],\[Dagger]], 
    Description      -> "Hermitian Conjugate of BDtilde matrix"
 },
  S[39] == { 
    ClassName     -> BDCD,
    Unphysical    -> True, 
    SelfConjugate -> False,
    Indices       -> {Index[SU2D], Index[RSU2D]},
    Unitary       -> False,
    Definitions   -> {
    BDCD[a_,b_] :> Module[{zz,uu}, del[BD[a,b],mu] - I gw/2 (Wi[mu,1] mult[Sig1,BD,a,b] + Wi[mu,2] mult[Sig2,BD,a,b] + Wi[mu,3] mult[Sig3,BD,a,b])
				   + I gw/2 (mult[BD,RSig1,a,b] WRi[mu,1] + mult[BD,RSig2,a,b] WRi[mu,2] + mult[BD,RSig3,a,b] WRi[mu,3])]},
    TeX           -> Superscript[V,BDCD],
    Description -> "Covariant Derivative of BD"},
  S[40] == {  
    ClassName        -> BDCDdagger,
    Unphysical       -> True, 
    SelfConjugate    -> False,
    Indices          -> {Index[RSU2D], Index[SU2D]},
    Unitary          -> False,
    Definitions      -> { 
    BDCDdagger[a_,b_] :> Module[{}, HC[BDCD[b,a]]]},
    TeX              -> Superscript[V,BDCDdagger], 
    Description      -> "Hermitian Conjugate of Covariant Derivative of BD"
 },
  S[41] == { 
    ClassName      -> mult, 
    Unphysical     -> True, 
    Indices        -> {Index[Dim2],Index[Dim2]},
    SelfConjugate  -> False,
    Definitions    -> { 
	mult[matr1_,matr2_,a_,b_] -> matr1[a,1] matr2[1,b] + matr1[a,2] matr2[2,b]}
  },
  S[42] == { 
    ClassName      -> trmult, 
    Unphysical     -> True, 
    Indices        -> {Index[Dim2],Index[Dim2]},
    SelfConjugate  -> False,
    Definitions    -> { 
	trmult[matr1_,matr2_] -> mult[matr1,matr2,1,1] + mult[matr1,matr2,2,2]}
  },
   S[43] == {
    ClassName      -> trCD,
    Unphysical     -> True, 
    SelfConjugate  -> False,
    Definitions    -> {
    trCD -> LCDdagger[1,1] LCD[1,1] + LCDdagger[1,2] LCD[2,1] + LCDdagger[2,1] LCD[1,2] + LCDdagger[2,2] LCD[2,2]  + 
            RCDdagger[1,1] RCD[1,1]  + RCDdagger[1,2] RCD[2,1]  + RCDdagger[2,1] RCD[1,2] + RCDdagger[2,2] RCD[2,2] + 
            BDCDdagger[1,1] BDCD[1,1] + BDCDdagger[1,2] BDCD[2,1] + BDCDdagger[2,1] BDCD[1,2] + BDCDdagger[2,2] BDCD[2,2] }
 },
  S[44] == { 
    ClassName      -> poten, 
    Unphysical     -> True, 
    SelfConjugate  -> False,
    Definitions    -> { 
	poten -> -musq[1]*trmult[BDdagger,BD]-musq[2]*(trmult[BDtilde,BDdagger]+trmult[BDtildedagger,BD])-musq[3]*(trmult[LT,LTdagger]+trmult[RT,RTdagger])
	+lambda1*trmult[BD,BDdagger]^2+lambda2*(trmult[BDtilde,BDdagger]^2+trmult[BDtildedagger,BD]^2)
	+lambda3*trmult[BDtilde,BDdagger]*trmult[BDtildedagger,BD]+lambda4*trmult[BD,BDdagger]*(trmult[BDtilde,BDdagger]+trmult[BDtildedagger,BD])
	+rho1*(trmult[LT,LTdagger]^2+trmult[RT,RTdagger]^2)+rho2*(trmult[LT,LT]*trmult[LTdagger,LTdagger]+trmult[RT,RT]*trmult[RTdagger,RTdagger])
	+rho3*trmult[LT,LTdagger]*trmult[RT,RTdagger]+rho4*(trmult[LT,LT]*trmult[RTdagger,RTdagger]+trmult[LTdagger,LTdagger]*trmult[RT,RT])
	+alpha1*trmult[BD,BDdagger]*(trmult[LT,LTdagger]+trmult[RT,RTdagger])
	+alpha2*(trmult[BD,BDtildedagger]*trmult[RT,RTdagger]+trmult[BDdagger,BDtilde]*trmult[LT,LTdagger]+
	trmult[BDdagger,BDtilde]*trmult[RT,RTdagger]+trmult[BDtildedagger,BD]*trmult[LT,LTdagger])
	+alpha3*(mult[BD, BDdagger, 1, 1]*mult[LT, LTdagger, 1, 1]+mult[BD, BDdagger, 1, 2]*mult[LT, LTdagger, 2, 1]+
			   mult[BD, BDdagger, 2, 1]*mult[LT, LTdagger, 1, 2]+mult[BD, BDdagger, 2, 2]*mult[LT, LTdagger, 2, 2]+
			   mult[BD, BDdagger, 1, 1]*mult[RT, RTdagger, 1, 1]+mult[BD, BDdagger, 1, 2]*mult[RT, RTdagger, 2, 1]+
			   mult[BD, BDdagger, 2, 1]*mult[RT, RTdagger, 1, 2]+mult[BD, BDdagger, 2, 2]*mult[RT, RTdagger, 2, 2])}
  }
 
};


(* ************************** *)
(* *****     Gauge      ***** *)
(* *****   Parameters   ***** *)
(* *****   (FeynArts)   ***** *)
(* ************************** *)

GaugeXi[ V[1]  ] = GaugeXi[A];
GaugeXi[ V[2]  ] = GaugeXi[Z];
GaugeXi[ V[3]  ] = GaugeXi[W];
GaugeXi[ V[4]  ] = GaugeXi[G];
GaugeXi[ V[5]  ] = GaugeXi[W2];
GaugeXi[ V[6]  ] = GaugeXi[Z2];
GaugeXi[ S[1]  ] = 1;
GaugeXi[ S[2]  ] = GaugeXi[Z];
GaugeXi[ S[3]  ] = GaugeXi[W];


(* ************************** *)
(* *****   Parameters   ***** *)
(* ************************** *)
M$Parameters = {

  (* External parameters *)
  
  aEWM1 == {ParameterType -> External, BlockName -> SMINPUTS, OrderBlock -> 1, Value -> 127.9, InteractionOrder -> {QED,-2}, Description -> "Inverse of the EW coupling constant at the Z pole"},
  Gf == {ParameterType -> External, BlockName -> SMINPUTS, OrderBlock -> 2, Value -> 1.16637*^-5, InteractionOrder -> {QED,2}, TeX -> Subscript[G,f], Description -> "Fermi constant"},
  aS    == {ParameterType -> External, BlockName -> SMINPUTS, OrderBlock -> 3, Value -> 0.1184, InteractionOrder -> {QCD,2}, TeX -> Subscript[\[Alpha],s], Description -> "Strong coupling constant at the Z pole"},
  s12 == {ParameterType -> External, BlockName -> CKMBLOCK, OrderBlock -> 1, Value -> 0.221, TeX -> Subscript[s, 12], Description   -> "CKMs12"},
  s23 == {ParameterType -> External, BlockName -> CKMBLOCK, OrderBlock -> 2, Value -> 0.041, TeX -> Subscript[s, 23], Description   -> "CKMs23"},
  s13 == {ParameterType -> External, BlockName -> CKMBLOCK, OrderBlock -> 3, Value -> 0.0035, TeX -> Subscript[s, 13], Description   -> "CKMs13"},
  sL12 == {ParameterType -> External, BlockName -> PMNSBLOCK, OrderBlock -> 1, Value -> 0, TeX -> Subscript[sL, 12], Description   -> "sL12"},
  sL23 == {ParameterType -> External, BlockName -> PMNSBLOCK, OrderBlock -> 2, Value -> 0, TeX -> Subscript[sL, 23], Description   -> "sL23"},
  sL13 == {ParameterType -> External, BlockName -> PMNSBLOCK, OrderBlock -> 3, Value -> 0, TeX -> Subscript[sL, 13], Description   -> "sL13"},
  lambda1== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 1, Value -> 0.118, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Lambda],1], Description   -> "Higgs potential lambda1"},
  lambda2== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 2, Value -> 0.2, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Lambda],2], Description   -> "Higgs potential lambda2"},
  lambda3== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 3, Value -> -0.234, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Lambda],3], Description   -> "Higgs potential lambda3"},
  lambda4== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 4, Value -> 0, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Lambda],4], Description   -> "Higgs potential lambda4"},
  rho1== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 5, Value -> 0.5, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Rho],1], Description   -> "Higgs potential rho1"},
  rho2== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 6, Value -> 0.05, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Rho],2], Description   -> "Higgs potential rho2"},
  rho3== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 7, Value -> 1.25, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Rho],3], Description   -> "Higgs potential rho3"},  
  rho4== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 8, Value -> 0.125, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Rho],4], Description   -> "Higgs potential rho4"},
  alpha1== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 9, Value -> 0.5, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Alpha],1], Description   -> "Higgs potential alpha1"},
  alpha2== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 10, Value -> 0.5, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Alpha],2], Description   -> "Higgs potential alpha2"},
  alpha3== {ParameterType -> External, BlockName -> HIGGSBLOCK, OrderBlock -> 11, Value -> 0.5, InteractionOrder -> {QED, 2}, TeX -> Subscript[\[Alpha],3], Description   -> "Higgs potential alpha3"},
  Wl11 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 1, Value -> 1, TeX -> Subscript[Wl, 11], Description   -> "Mixing parameter Wl11"},
  Wl22 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 2, Value -> 1, TeX -> Subscript[Wl, 22], Description   -> "Mixing parameter Wl22"},
  Wl33 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 3, Value -> 1, TeX -> Subscript[Wl, 33], Description   -> "Mixing parameter Wl33"},
  WU11 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 4, Value -> 1, TeX -> Subscript[WU, 11], Description   -> "Mixing parameter WU11"},
  WU22 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 5, Value -> 1, TeX -> Subscript[WU, 22], Description   -> "Mixing parameter WU22"},
  WU33 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 6, Value -> 1, TeX -> Subscript[WU, 33], Description   -> "Mixing parameter WU33"},
  WD11 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 7, Value -> 1, TeX -> Subscript[WD, 11], Description   -> "Mixing parameter WD11"},
  WD22 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 8, Value -> 1, TeX -> Subscript[WD, 22], Description   -> "Mixing parameter WD22"},
  WD33 == {ParameterType -> External, BlockName -> MIXINGBLOCK, OrderBlock -> 9, Value -> 1, TeX -> Subscript[WD, 33], Description   -> "Mixing parameter WD33"},
  VKe == {ParameterType -> External, BlockName -> KLRBLOCK, OrderBlock -> 1, Definitions -> {VKe -> Sqrt[0.00001]}, TeX -> Subscript[KLRmix, e], Description   -> "Lepton mixing parameter e"},
  VKmu == {ParameterType -> External, BlockName -> KLRBLOCK, OrderBlock -> 2, Definitions -> {VKmu -> Sqrt[0.00001]}, TeX -> Subscript[KLRmix, mu], Description   -> "Lepton mixing parameter mu"},
  VKta == {ParameterType -> External, BlockName -> KLRBLOCK, OrderBlock -> 3, Definitions -> {VKta -> Sqrt[0.00001]}, TeX -> Subscript[KLRmix, ta], Description   -> "Lepton mixing parameter ta"},
  vev == {ParameterType -> External, BlockName -> VEVS, OrderBlock -> 1, Value -> 246.0, InteractionOrder -> {QED,-1}, Description -> "Higgs vacuum expectation value"},  
  k1 == {ParameterType -> External, BlockName -> VEVS, OrderBlock -> 2, Value -> 227.91, InteractionOrder -> {QED,-1}, Description -> "bidoublet vacuum expectation 1"},  
  vR == {ParameterType -> External, BlockName -> VEVS, OrderBlock -> 3, Value -> 2543.2, InteractionOrder -> {QED,-1}, Description -> "right triplet vacuum expectation"},  
  vL == {ParameterType -> External, BlockName -> VEVS, OrderBlock -> 4, Value -> 0, InteractionOrder -> {QED,-1}, Description -> "left triplet vacuum expectation"},  
  sk2 == {ParameterType -> External, BlockName -> VEVS, OrderBlock -> 5, Value -> 1, InteractionOrder -> {QED,-1}, Description -> "the sign of k2"},  
  
  (* Internal Parameters *)
  
  aEW == {
    ParameterType    -> Internal,
    Value            -> 1/aEWM1,
    InteractionOrder -> {QED,2},
    TeX              -> Subscript[\[Alpha], EW],
    Description      -> "Electroweak coupling contant"
  },
  sw2 == { 
    ParameterType -> Internal, 
    Value         -> 1-(MW/MZ)^2, 
    Description   -> "Squared Sin of the Weinberg angle"
  },
  sw == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[sw2], 
    TeX           -> Subscript[s,w], 
    Description   -> "Sine of the Weinberg angle"
  },
  ee == { 
    ParameterType    -> Internal, 
    Value            -> Sqrt[4 Pi aEW], 
    InteractionOrder -> {QED,1}, 
    TeX              -> e,  
    Description      -> "Electric coupling constant"
  },
  cw == { 
    ParameterType -> Internal, 
    Value         -> MW/MZ,
    TeX           -> Subscript[c,w], 
    Description   -> "Cosine of the Weinberg angle"
  },
  gw == { 
    ParameterType    -> Internal, 
    Value            -> ee/sw, 
    InteractionOrder -> {QED,1},  
    TeX              -> Subscript[g,w], 
    Description      -> "Weak coupling constant at the Z pole"
  },
  g1 == { 
    ParameterType    -> Internal, 
    Value            -> ee/Sqrt[1-2*sw^2], 
    InteractionOrder -> {QED,1},  
    TeX              -> Subscript[g,1], 
    Description      -> "U(1)Y coupling constant at the Z pole"
  },
  gs == { 
    ParameterType    -> Internal, 
    Value            -> Sqrt[4 Pi aS],
    InteractionOrder -> {QCD,1},  
    TeX              -> Subscript[g,s], 
    Description      -> "Strong coupling constant at the Z pole"
  },
  k2 == {
    ParameterType    -> Internal,
    Value            -> sk2*Sqrt[vev^2-k1^2], 
    InteractionOrder -> {QED,-1},
    Description      -> "bidoublet vacuum expectation 2"
  },  
  eps == {
    ParameterType    -> Internal,
    Value            -> 2*k1*k2/vev^2, 
    Description      -> "epsilon parameter"
  },  
  MW2 == { 
    ParameterType -> Internal, 
    Value         -> gw/2*Sqrt[vev^2+vR^2+Sqrt[vR^4+4*k1^2*k2^2]], 
    TeX           -> Subscript[M,W2], 
    Description   -> "W2 mass"
  },
  MZ2 == { 
    ParameterType -> Internal, 
    Value         -> 1/2*Sqrt[gw^2*vev^2+2*vR^2*(gw^2+g1^2)+Sqrt[(gw^2*vev^2+2*vR^2*(gw^2+g1^2))^2-4*gw^2*(gw^2+2g1^2)*vev^2*vR^2]], 
    TeX           -> Subscript[M,Z2], 
    Description   -> "Z2 mass"
  },
  sxi == { 
    ParameterType -> Internal, 
    Value         -> (-k1*k2/vR^2)/(Sqrt[2+2(-k1*k2/vR^2)^2]*Sqrt[1+1/Sqrt[1+(-k1*k2/vR^2)^2]]), 
    TeX           -> Subscript[s,\[Theta]], 
    Description   -> "sin of W mixing angle"
  },
  cxi == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[1-sxi^2], 
    TeX           -> Subscript[c,\[Theta]], 
    Description   -> "cos of W mixing angle"
  },
  sphi == {
    ParameterType    -> Internal,
    Value            -> -Sqrt[0.5-0.5*Sqrt[1-(vev^2*gw^2*Sqrt[1-2*sw^2]/(2*cw^2*(MZ2^2-MZ^2)))^2]], 
    TeX              -> Subscript[s,\[Phi]],
    Description      -> "sin of oiler angle of the neutral gauge boson matrix"
  },  
   cphi == {
    ParameterType    -> Internal,
    Value            -> Sqrt[1-sphi^2], 
    TeX              -> Subscript[c,\[Phi]],
    Description      -> "cos of oiler angle of the neutral gauge boson matrix"
  },  
  int1 == {
   ParameterType    -> Internal,
   Value            -> k1/(vev*Sqrt[1+0.5*((k1^2-k2^2)/(vev*vR))^2]),
   TeX              -> Subscript[int,1],
   Description      -> "Higgs-coefficient"
   },
  int2 == {
   ParameterType    -> Internal,
   Value            -> k2/(vev*Sqrt[1+0.5*((k1^2-k2^2)/(vev*vR))^2]),
   TeX              -> Subscript[int,2],
   Description      -> "Higgs-coefficient"
   },
  int3 == {
   ParameterType    -> Internal,
   Value            -> 1/Sqrt[1+2*((vev*vR)/(k1^2-k2^2))^2],
   TeX              -> Subscript[int,3],
   Description      -> "Higgs-coefficient"
   },
  musq == {
    ParameterType -> Internal,
    Indices       -> {Index[MusqI]},
    Definitions   -> {musq[1] -> vR^2*(alpha1/2-alpha3*k2^2/(2k1^2-2k2^2))+(k1^2+k2^2)*lambda1+2*k1*k2*lambda4, 
					  musq[2] -> vR^2*(alpha2/2+alpha3*k1*k2/(4k1^2-4k2^2))+k1*k2*(2*lambda2+lambda3)+lambda4*(k1^2+k2^2)/2,
					  musq[3] -> alpha1*(k1^2+k2^2)/2+2*alpha2*k1*k2+alpha3*k2^2/2+vR^2*rho1},
    TeX           -> Superscript[\[Mu],2],
    Description   -> "The potential parameters mu^2"
  },  
  MH == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[2*vev^2*(lambda1+eps^2*(2*lambda1+lambda3)+2*lambda4*eps)],
    TeX           -> Subscript[M,H], 
    Description   -> "SM Higgs mass"
  },
  MH01 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[alpha3/2*vR^2/Sqrt[1-eps^2]],
    TeX           -> Subscript[M,H01], 
    Description   -> "Neutral Higgs H01 mass"
  },
  MH02 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[2*rho1*vR^2],
    TeX           -> Subscript[M,H02], 
    Description   -> "Neutral Higgs H02 mass"
  },
  MH03 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[1/2*vR^2*(rho3-2*rho1)],
    TeX           -> Subscript[M,H03], 
    Description   -> "Neutral Higgs H03 mass"
  },
  MA01 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[alpha3/2*vR^2/Sqrt[1-eps^2]-2*vev^2*(2*lambda2-lambda3)],
    TeX           -> Subscript[M,A01], 
    Description   -> "Neutral Pseudiscalar Higgs A01 mass"
  },
  MA02 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[vR^2/2*(rho3-2*rho1)],
    TeX           -> Subscript[M,A02], 
    Description   -> "Neutral Pseudiscalar Higgs A02 mass"
  },
  MHP1 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[vR^2/2*(rho3-2*rho1)+alpha3/4*vev^2*Sqrt[1-eps^2]],
    TeX           -> Subscript[M,HP1], 
    Description   -> "Singly charged Higgs HP1 mass"
  },
  MHP2 == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[alpha3/2*(vR^2/Sqrt[1-eps^2]+vev^2/2*Sqrt[1-eps^2])],
    TeX           -> Subscript[M,HP2], 
    Description   -> "Singly charged Higgs HP2 mass"
  },
 MHPPL == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[1/2*(vR^2*(rho3-2*rho1)+alpha3*vev^2*Sqrt[1-eps^2])],
    TeX           -> Subscript[M,HPPL], 
    Description   -> "Left handed Doubly charged Higgs mass"
  },
 MHPPR == { 
    ParameterType -> Internal, 
    Value         -> Sqrt[2*rho2*vR^2+alpha3/2*vev^2*Sqrt[1-eps^2]],
    TeX           -> Subscript[M,HPPR], 
    Description   -> "Right handed Doubly charged Higgs mass"
  },
 yML == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yML[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value            -> {yML[1,1] -> Me, yML[2,2] -> Mmu, yML[3,3] -> Mta},
    TeX              -> Subscript[MCL, diag],
    Description      -> "diagonal charged-lepton Yukawa masses"
  },
 yNL == {
    ParameterType    -> Internal,
    Indices          -> {Index[Gen2], Index[Gen2]},
    Definitions      -> {yNL[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value            -> {yNL[1,1] -> MN1, yNL[2,2] -> MN2, yNL[3,3] -> MN3, yNL[4,4] -> MN4, yNL[5,5] -> MN5, yNL[6,6] -> MN6},
    TeX              -> Subscript[MNL, diag],
    Description      -> "diagonal Majorana neutrinos masses"
  },
 Mdirac == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {Mdirac[a_,b_] -> Module[{sp1,sp2}, HC[KL[sp1,a]] yNL[sp1,sp2] KR[sp2,b]]}, 
    TeX              -> MDirac,
    Description      -> "Dirac block in neutrinos mass matrix"
  },
 Mr == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {Mr[a_,b_] -> Module[{sp1,sp2}, KR[sp1,a] yNL[sp1,sp2] KR[sp2,b]]},
    TeX              -> MR,
    Description      -> "Right block in neutrinos mass matrix"
  },
 yL == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yL[a_,b_] -> Sqrt[2]/(k1^2-k2^2) (k1 Mdirac[a,b] - k2 yML[a,b])}, 
    InteractionOrder -> {QED, 1},
    TeX              -> Subscript[h,L],
    Description      -> "Lepton matrix of Yukawa couplings"
  },
  yLtilde == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yLtilde[a_,b_] -> Sqrt[2]/(k1^2-k2^2) (-k2 Mdirac[a,b] + k1 yML[a,b])}, 
    InteractionOrder -> {QED, 1},
    TeX              -> Subscript[OverTilde[h],L],
    Description      -> "Lepton second matrix of Yukawa couplings"
  },
  yHM1 == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yHM1[a_,b_] -> 1/(vR*Sqrt[2]) Mr[a,b]}, 
    InteractionOrder -> {QED, 1},
    TeX              -> hM,
    Description      -> "Lepton third matrix of Yukawa couplings"
  },
  yHM2 == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yHM2[a_,b_] -> Module[{sp1,sp2}, 1/(vR*Sqrt[2]) Wl[a,sp1] Mr[sp1,sp2] Wl[sp2,b]]},  
    InteractionOrder -> {QED, 1},
    TeX              -> hM2,
    Description      -> "Lepton third matrix of Yukawa couplings"
  },
  yMU == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yMU[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value            -> {yMU[1,1] -> MU, yMU[2,2] -> MC, yMU[3,3] -> MT},
    TeX              -> Subscript[Mup, diag],
    Description      -> "diagonal Up-type Yukawa masses"
  },
  yDO == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yDO[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value            -> {yDO[1,1] -> MD, yDO[2,2] -> MS, yDO[3,3] -> MB},
    TeX              -> Subscript[Mdown, diag],
    Description      -> "diagonal Down-type Yukawa masses"
  },
  yQ == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yQ[a_,b_] :> Module[{sp5,sp6}, Sqrt[2]/(k1^2-k2^2) (k1 yMU[a,b] - k2 CKML[a,sp5] yDO[sp5,sp6] HC[CKMR[b,sp6]])]}, 
    InteractionOrder -> {QED, 1},
    TeX              -> Subscript[h,q],
    Description      -> "Quark matrix of Yukawa couplings"
  },
  yQtilde == {
    ParameterType    -> Internal,
    Indices          -> {Index[Generation], Index[Generation]},
    Definitions      -> {yQtilde[a_,b_] :> Module[{sp5,sp6}, Sqrt[2]/(k1^2-k2^2) (-k2 yMU[a,b] + k1 CKML[a,sp5] yDO[sp5,sp6] HC[CKMR[b,sp6]])]}, 
    InteractionOrder -> {QED, 1},
    TeX              -> Subscript[OverTilde[h],q],
    Description      -> "Quark second matrix of Yukawa couplings"
  },
  CKML == { 
    ParameterType -> Internal,
    Indices       -> {Index[Generation], Index[Generation]},
    Unitary       -> True,
    Value         -> {CKML[1,1] -> Sqrt[1-s12^2]*Sqrt[1-s13^2],  CKML[1,2] -> s12*Sqrt[1-s13^2], CKML[1,3] -> s13,
                      CKML[2,1] -> -s12*Sqrt[1-s23^2]-Sqrt[1-s12^2]*s23*s13, CKML[2,2] -> Sqrt[1-s12^2]*Sqrt[1-s23^2]-s12*s23*s13, CKML[2,3] -> s23*Sqrt[1-s13^2],
                      CKML[3,1] -> s12*s23-Sqrt[1-s12^2]*Sqrt[1-s23^2]*s13, CKML[3,2] -> -Sqrt[1-s12^2]*s23-s12*Sqrt[1-s23^2]*s13, CKML[3,3] -> Sqrt[1-s23^2]*Sqrt[1-s13^2]},
    TeX         -> Superscript[V,CKML],
    Description -> "CKML-Matrix"},
 Sig1 == { 
    ParameterType -> Internal,
    Indices       -> {Index[SU2D], Index[SU2D]},
    Definitions   -> {Sig1[1,1] -> 0, Sig1[1,2] -> 1, Sig1[2,1] -> 1, Sig1[2,2] -> 0},
    TeX           -> Sig1,
    Description   -> "Left-Sigma1-Matrix"}, 
  Sig2 == { 
    ParameterType -> Internal,
    Indices       -> {Index[SU2D], Index[SU2D]},
    Definitions   -> {Sig2[1,1] -> 0, Sig2[1,2] -> -I, Sig2[2,1] -> I, Sig2[2,2] -> 0},
    TeX           -> Sig2,
    Description   -> "Left-Sigma2-Matrix"},
  Sig3 == { 
    ParameterType -> Internal,
    Indices       -> {Index[RSU2D], Index[RSU2D]},
    Definitions   -> {Sig3[1,1] -> 1, Sig3[1,2] -> 0, Sig3[2,1] -> 0, Sig3[2,2] -> -1},
    TeX           -> Sig3,
    Description   -> "Left-Sigma1-Matrix"}, 
  RSig1 == { 
    ParameterType -> Internal,
    Indices       -> {Index[RSU2D], Index[RSU2D]},
    Definitions   -> {RSig1[1,1] -> 0, RSig1[1,2] -> 1, RSig1[2,1] -> 1, RSig1[2,2] -> 0},
    TeX           -> Sig1,
    Description   -> "Right-Sigma1-Matrix"}, 
  RSig2 == { 
    ParameterType -> Internal,
    Indices       -> {Index[RSU2D], Index[RSU2D]},
    Definitions   -> {RSig2[1,1] -> 0, RSig2[1,2] -> -I, RSig2[2,1] -> I, RSig2[2,2] -> 0},
    TeX           -> Sig2,
    Description   -> "Right-Sigma2-Matrix"},
  RSig3 == { 
    ParameterType -> Internal,
    Indices       -> {Index[SU2D], Index[SU2D]},
    Definitions   -> {RSig3[1,1] -> 1, RSig3[1,2] -> 0, RSig3[2,1] -> 0, RSig3[2,2] -> -1},
    TeX           -> Sig3,
    Description   -> "Right-Sigma1-Matrix"}, 
  Wl == { 
    ParameterType -> Internal,
    Indices       -> {Index[Generation],Index[Generation]},
    Definitions   -> {Wl[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value         -> {Wl[1,1] -> Wl11, Wl[2,2] -> Wl22, Wl[3,3] -> Wl33},
    TeX         -> Superscript[V,qW],
    Description -> "Quassi-manifest lepton matrix"},
  WU == { 
    ParameterType -> Internal,
    Indices       -> {Index[Generation],Index[Generation]},
    Definitions   -> {WU[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value         -> {WU[1,1] -> WU11, WU[2,2] -> WU22, WU[3,3] -> WU33},
    TeX         -> Superscript[V,WU],
    Description -> "Quassi-manifest up-quark matrix"},
  WD == { 
    ParameterType -> Internal,
    Indices       -> {Index[Generation],Index[Generation]},
    Definitions   -> {WD[i_?NumericQ, j_?NumericQ] :> 0  /; (i =!= j)},
    Value         -> {WD[1,1] -> WD11, WD[2,2] -> WD22, WD[3,3] -> WD33},
    TeX         -> Superscript[V,WD],
    Description -> "Quassi-manifest down-quark matrix"},
  CKMR == { 
    ParameterType -> Internal,
    Indices       -> {Index[Generation], Index[Generation]},
    Unitary       -> True,
    Value         -> {CKMR[a_,b_] -> WU[a,a]*WD[b,b]*CKML[a,b]},
    TeX         -> Superscript[V,CKMR],
    Description -> "CKMR-Matrix"},
  KL == { 
    ParameterType -> Internal,
    Indices       -> {Index[Gen2],Index[Generation]},
    Definitions   -> {KL[4,2] :> 0, KL[4,3] :> 0,
					  KL[5,1] :> 0, KL[5,3] :> 0,
					  KL[6,1] :> 0, KL[6,2] :> 0},
    Value         -> {KL[1,1] -> Sqrt[1-sL12^2]*Sqrt[1-sL13^2],  KL[1,2] -> sL12*Sqrt[1-sL13^2], KL[1,3] -> sL13,
                      KL[2,1] -> -sL12*Sqrt[1-sL23^2]-Sqrt[1-sL12^2]*sL23*sL13, KL[2,2] -> Sqrt[1-sL12^2]*Sqrt[1-sL23^2]-sL12*sL23*sL13, KL[2,3] -> sL23*Sqrt[1-sL13^2],
                      KL[3,1] -> sL12*sL23-Sqrt[1-sL12^2]*Sqrt[1-sL23^2]*sL13, KL[3,2] -> -Sqrt[1-sL12^2]*sL23-sL12*Sqrt[1-sL23^2]*sL13, KL[3,3] -> Sqrt[1-sL23^2]*Sqrt[1-sL13^2],
					  KL[4,1] -> VKe, 
					  KL[5,2] -> VKmu, 
					  KL[6,3] -> VKta},
    TeX         -> Superscript[V,KL],
    Description -> "Left-handed-leptonic-mixing-Matrix"},
  KR == { 
    ParameterType -> Internal,
    Indices       -> {Index[Gen2],Index[Generation]},
    Definitions   -> {KR[1,2] :> 0, KR[1,3] :> 0,
					  KR[2,1] :> 0, KR[2,3] :> 0,
					  KR[3,1] :> 0, KR[3,2] :> 0,
					  KR[4,2] :> 0, KR[4,3] :> 0,
					  KR[5,1] :> 0, KR[5,3] :> 0,
					  KR[6,1] :> 0, KR[6,2] :> 0},
    Value         -> {KR[1,1] -> -VKe, 
					  KR[2,2] -> -VKmu, 
					  KR[3,3] -> -VKta,
					  KR[4,1] -> 1, 
					  KR[5,2] -> 1, 
					  KR[6,3] -> 1},
    TeX         -> Superscript[V,KR],
    Description -> "Right-handed-leptonic-mixing-Matrix"}
};

(* ************************** *)
(* *****   Lagrangian   ***** *)
(* ************************** *)

LGauge := Block[{mu,nu,ii,aa}, 
  ExpandIndices[-1/4 FS[B,mu,nu] FS[B,mu,nu] - 1/4 FS[Wi,mu,nu,ii] FS[Wi,mu,nu,ii] - 1/4 FS[WRi,mu,nu,ii] FS[WRi,mu,nu,ii] - 1/4 FS[G,mu,nu,aa] FS[G,mu,nu,aa], FlavorExpand->{SU2W,SU2W2}]];
  
LFermions := Block[{mu}, 
  ExpandIndices[I*(
    LLbar.Ga[mu].DC[LL, mu]+
    LRbar.Ga[mu].DC[LR, mu]+
    QLbar.Ga[mu].DC[QL, mu]+
    QRbar.Ga[mu].DC[QR, mu]), 
    FlavorExpand->{SU2W,SU2W2,SU2D,RSU2D}]/.{CKML[a_,b_] Conjugate[CKML[a_,c_]]->IndexDelta[b,c], CKML[b_,a_] Conjugate[CKML[c_,a_]]->IndexDelta[b,c],
				 KL[a_,b_] Conjugate[KL[a_,c_]]->IndexDelta[b,c],
				 KR[a_,b_] Conjugate[KR[a_,c_]]->IndexDelta[b,c],g1 Sqrt[1-2sw^2]->gw sw}];

LYukawa := Block[{sp,ii,tt,jj,cc,ff1,ff2,yuk,yuk2},
  
  yuk = ExpandIndices[
   QLbar[sp, ii, ff1, cc].QR[sp, tt, ff2, cc] (-yQ[ff1, ff2] BD[ii,tt] - yQtilde[ff1,ff2] BDtilde[ii,tt])
   + LLbar[sp, ii, ff1].LR[sp, tt, ff2] (-yL[ff1,ff2] BD[ii,tt] - yLtilde[ff1,ff2] BDtilde[ii,tt]), FlavorExpand -> {SU2D,RSU2D}];
  yuk = yuk /. { CKML[a_, b_] Conjugate[CKML[a_, c_]] -> IndexDelta[b, c], CKML[b_, a_] Conjugate[CKML[c_, a_]] -> IndexDelta[b, c],
				 KL[a_,b_] Conjugate[KL[a_,c_]]->IndexDelta[b,c],
				 KR[a_,b_] Conjugate[KR[a_,c_]]->IndexDelta[b,c]}; 
  yuk2 = ExpandIndices[
  LCLbar[sp, ii, ff1].LR[sp, tt, ff2] (-yHM1[ff1,ff2]) SigR[ii,tt] + LCRbar[sp, ii, ff1].LL[sp, tt, ff2] (-yHM2[ff1,ff2]) SigL[ii,tt], FlavorExpand -> {SU2D,RSU2D}];
  yuk2 = yuk2 /. { KL[a_,b_] Conjugate[KL[a_,c_]]->IndexDelta[b,c],
				   KR[a_,b_] Conjugate[KR[a_,c_]]->IndexDelta[b,c]};
  yuk+HC[yuk]+yuk2+HC[yuk2]
 ]; 
				
LHiggs := Block[{ii,mu},
  ExpandIndices[trCD  - poten, FlavorExpand -> {SU2D,RSU2D,Dim2,SU2W,SU2W2}]
 ];
 
LGhost := Block[{LGhs,mu},

  LGhs = -ghGbar.del[DC[ghG,mu],mu];

ExpandIndices[ LGhs, FlavorExpand->{SU2W,SU2W2}]];

LLR:=  LGauge+LFermions+LYukawa+LHiggs+LGhost;
